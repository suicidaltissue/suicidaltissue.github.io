---
type: Lecture Notes
panopto: https://ultra.content.blackboardcdn.com/ultra/uiv3900.84.0-rel.32_5b918c5#
lecturer: 
slides: https://blackboard.aber.ac.uk/ultra/courses/_46446_1/outline/edit/document/_2743650_1?courseId=_46446_1&view=content
notesCompleted: true
module: CS24520
---
# [Pandas](https://pandas.pydata.org)

Pandas is a data analysis and manipulation tool that is part of the scientific python ecosystem
it provides a number of data analysis freatures including
 - Reading a writing data (CSV, Text, Excel, SQL)
 - Handling missing data and cleaning up data
 - Size Mutability??
 - Flexible data alignment and indexing
 - Powerful and flexible group_by functionality

## Data Structures
Series: One-dimensional labeled data structure of any data type

## Data Frames
A Data frame is a two dimensional and potentially heterogeneous tabular data structure.
Similar to an Excel spreadsheet, a column represents the different attributes of the data
and the row represents a different instance of data.

![[Pasted image 20240222214151.png]]

### Creating Dataframes

#### Converting Arrays

```python
import numpy as np
import pandas as pd

x = range(0,20)     # [0,1,2,3,4,5,6,7,8,9,10, etc]
sin_x = np.sin(x)   # [ 0., 0.84147098, 0.90929743, etc... ]
cos_x = np.cos(x)   # [1., 0.54030231, -0.41614684, etc... ]

data = pd.DataFrame({'x': x, 'sin': sin_x, 'cos': cos_x})
print(data) 
```

this generates a data frame using the provided values

#### Reading a data file

```python
brain_data = pd.read_csv('brain.csv')
```

This will automatically create a Data Frame from the CSV file provided.

##### More Options
| Parameter   | Values     | Description |
| ----------- | ---------- | ----------- |
| parse_dates | True,False |             |
|             |            |             |
|             |            |             |
|             |            |             |
|             |            |             |

### Exploring a Data Frame

```python
brain_data.shape    # Similarly to NumPy you can get the row,col count
brain_data.columns  # Returns a list of column names (labels)
```

as well as this you can find
the number of non-null values for each column
with `brain_data.count()`


#### Statistical Summary
To generate a statistical summary for just the numeric columns of a DataFrame

```python
brain_data.describe()
```

this returns data such as count, mean, min, max for each numerical column.



#### Checking Data Types

```python
brain_data.dtypes # Returns a list of the datatypes of each columns
```

```python
"""
Gender       object
FSIQ        float64
VIQ         float64
PIQ         float64
Weight      float64
Height      float64
MRICount    float64
dtype: object
"""
```
### Accessing Data in a Data Frame

the `head()` and `tail()` methods can be used to extract the top and bottom few rows

```python
brain_data.head(2)   #Returns first two rows
brain_data.tails(2)  #Returns last two rows
```

#### Slicing Operations- f__obs:

| Data Slice                                             | Slicing Approach                               | Output |
| ------------------------------------------------------ | ---------------------------------------------- | ------ |
| Column(s)<br>- Single Column<br>- Multiple Columns<br> | <br>Column Label in []<br>Column Label in [[]] |        |
| Row(s)                                                 |                                                |        |
| Subset*                                                |                                                |        |


#### Label vs Integer Positions
lets say we read a csv into pandas, automatically a index column is generated (starting from 0)
the normal way to access this data would be through this index column. You are able to specify another column to use as the index column instead of an autogenerated id, you can do this with

```python
data = pd.read_csv("brain.csv", index_col=[1], parse_dates=[1])
```

#### `loc` vs `iloc`
`loc` is used when slicing a database by label
`iloc` is used when slicing by integer positions

we can specify a range of labels/positions in loc and iloc attributes, for example

```python
brain_data.iloc[0:3, 0:4] # Returns Row Positions 0-3 and column positions 0-4
```

#### Address a single column
To select one column specify a column label `brain_data["FSIQ"]` you can then apply a function or call a series method to do something with that data.

#### Address Multiple Columns
To select multiple columns we can use `brain_data[['FSIQ','Gender','PIQ']]`
you can also use `[[]]` when accessing a single column in order to get a Data Frame back.

#### Address Rows
You can address a number of rows by using row integer positions, similar to the `range()` function in plain python, you can used `brain_data[start:stop:step]` in order to get the resulting range of rows.
##### More Options
| Characters | Usage       |
| ---------- | ----------- |
| :-n        | Up Until    |
| ::-n       | Excluding n |

##### Boolean Selection
You are able to extract only data that matches a conditional, lets say we want to find every row where the gender is male. This can be accomplished with

```python
brain_data[(brain_data['Gender']=='Male')]
```

you can then also combine this with loc to return specific data from each matching row

```python
brain_data[(brain_data['Gender']=='Male'), ['Gender', 'PIQ', 'VIQ']]
```

##### `loc` and boolean selection
You can request rows with conditions and some columns.
```python
brain_data.loc[brain_data['Gender']=="Male", ['Gender', 'PIQ', 'VIQ']]

#Returns Gender, PIQ and VIQ for all Male Entries.
```

#### Dataframe Methods
Pandas offers a number of methods for DataFrames which allow you to apply calculations on a whole set
`mean()`, `max()`, `min()`, `count()`, `sum()`

```python
brain_data.mean()
brain_data.max()
```

these methods can also be applied to slices or subsets or a DataFrame
```python
PIQ = brain_data['PIQ']
average = PIQ.mean()
```


### Sorting a DataFrame
You can use the `sort_values` method on a DataFrame to sort based on a specific column, unless `inplace=True` it will return a copy of the DataFrame
```python
brain_data.sort_values(by=['Gender'])
```
you can add multiple column names between `[]` in order to sort by them.

### GroupBy
Allows you to split a dataframe on values of categorical variables.

```python
data_genders = brain_data.groupby('Gender') # Returns a GroupBy Object
for gender in data_genders:
    print(gender)
```

you can also then apply methods to each group, we will look at `max()` but you can apply any of the methods discussed above.

```python
data_genders.max() #Applies max() to each column of each group in the dataframe
```

you can also use this with specific columns in each group, for example we want to get the maximum weight for both male and female we can use

```python
data_genders['Weight'].min()
```

### Manipulating a DataFrame
you are able to modify values, add or delete rows/columns

#### Modify Value
```python
brain_data['MRICount'] = brain_data['MRICount'] / 1000
```

#### New Column
lets add a new column for BMI which is calculated with **weight(kg)/((height(m))**2)**

```python
def getDMI(weight, height):
	return (weight * 0.45359237) / (height * 0.0254)**2)

brain_data['BMI'] = getBMI(brain_data['Weight'], brain_data['Height'])
```

#### Delete Columns / Rows
To Drop Columns you can use
```python
brain_data.drop(columns=["BMI", "Weight"], inplace=True) 
```

or for dropping rows you can use
```python
brain_data.drop([0,2], inplace=True)
```

### Saving a DataFrame
There are a number of ways to export data from a DataFrame for use later depending on how the data will be used later you may want to use any of the following methods.

```python
brain_data.to_csv("filename.csv", index=False)
brain_data.to_excel("filename.csv", index=False)
```

### Plotting data in DataFrame
We can apply what we learnt in [[10. Plotting]] using matplotlib to plot Pandas DataFrames.

Pandas uses matplotlib to expose a number of high level plotting methods for visualising DataFrames.

#### Line Plots
![[Pasted image 20240308191736.png]]
```python
data = pd.read_csv("raintemp.csv", sep="\t", usecols=[0,1,3], names=["year", "winter", "summer"], skiprows=1, index_col="year")

data.plot(title="UK Mean Tempretures", ylabel="Degrees Centigrade")
```

#### Bar Plots
![[Pasted image 20240308191720.png]]
```python
data = pd.read_csv("")
average_by_gender = data.groupby('Gender')[['Weight', 'Height']].mean()
average_by_gender.plot(kind="bar")
```

#### Cross-tabulation
can be used to summarize data into different groups
you can use the [crosstab()](https://pandas.pydata.org/docs/reference/api/pandas.crosstab.html) method to do this in pandas.

![[Pasted image 20240308191927.png]]

```python
weightbygender = pd.crosstab(brain_data['Gender'], brain_data['Weight'])
weightbygender.plot(kind="bar")
```

#### Histogram
![[Pasted image 20240308191936.png]]

```python
brain_data.hist()
brain_data['Gender'].hist()
```

#### Box Plots
![[Pasted image 20240308191945.png]]

```python
brain_data.groupby('Gender').boxplot(column=['FSIQ', 'VIQ', 'PIQ'])
```

#### Pie Plots
![[Pasted image 20240308191953.png]]

```python

```

- [ ] #todo Create Pieplot for Lecture12 Exercise 6
- [ ] #todo Create boxplot for Lecture12 Exercise 6


